$(function(){renderAll("client-ul","client-template","/:id/clients"),createClient(),enterClient(),addJob(),startTime(),stopTime(),toggleButtons(),logOut()});var render=function(t,n,e){var o=_.template($("#"+n).html());_(e).each(function(n){var e=$(o(n));$("#"+t).append(e)}),toggleButtons()},renderOne=function(t,n,e){var o=_.template($("#"+n).html()),i=$(o(e));$("#"+t).append(i)},renderAll=function(t,n,e){$.get(e,function(e){console.log(e),console.log(e),render(t,n,e)})},renderJobs=function(t){$("#content").load("/jobs.html",function(){$.get("/"+t+"/jobs",function(n){console.log(n[0].jobs),render("job-ul","job-template",n[0].jobs),$("#add-job").attr("data-client-id",t)})})},createClient=function(){$("#add-client").on("submit",function(t){t.preventDefault();var n=$(this).serialize();console.log(n),$.post("/clients",n,function(t){renderOne("client-ul","client-template",t)})})},addJob=function(){var t;$("section").on("submit","#add-job",function(n){n.preventDefault();var e=$(this).closest("form").serialize();t=$(this).closest("form").attr("data-client-id"),console.log(e),console.log(t),$.post("/"+t+"/jobs",e,function(t){console.log(t)}).done(function(){renderJobs(t)})})},enterClient=function(){$("ul").on("click",".enter-client",function(t){t.preventDefault();var n=$(this).closest("li")[0].id;console.log(n),renderJobs(n)})},startTime=function(){$("section").on("click",".start",function(t){t.preventDefault();var n=$(this).closest("li")[0].id;console.log(n);var e=$("form#add-job").attr("data-client-id");$.ajax({url:"/"+n+"/start",method:"PUT",data:{id:e},success:function(t){renderJobs(e)}})})},stopTime=function(){$("section").on("click",".stop",function(t){t.preventDefault();var n=$(this).closest("li")[0].id;console.log(n);var e=$("form#add-job").attr("data-client-id");$.ajax({url:"/"+n+"/stop",method:"PUT",data:{id:e},success:function(t,n){renderJobs(e)}})})},toggleButtons=function(){var t=$("#job-ul li");t.each(function(){"true"===$(this)[0].dataset.clockOn?($(this).children(".start").hide(),$(this).children(".stop").show()):($(this).children(".start").show(),$(this).children(".stop").hide())})},logOut=function(){$("#log-out").on("click",function(t){t.preventDefault(),$.post("/logout",function(){window.location="/"})})};